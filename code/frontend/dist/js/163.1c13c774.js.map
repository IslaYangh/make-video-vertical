{"version":3,"file":"js/163.1c13c774.js","mappings":"6PAGO,MAAMA,EAAcC,GAAUC,EAAAA,EAAAA,IAAQ,iBAAkB,CAAED,OAAAA,IAGpDE,EAAgBC,GAAMF,EAAAA,EAAAA,UAAW,aAAeE,GAGhDC,EAAgBC,GAC3BJ,EAAAA,EAAAA,KAAS,mBAAoBI,EAAI,CAC/BC,QAAS,CACP,eAAgB,yBAKTC,EAAiBP,GAC5BC,EAAAA,EAAAA,KAAS,0BAA2BD,EAAQ,CAC1CQ,aAAa,IAIJC,EAAcT,GAAUC,EAAAA,EAAAA,IAAQ,sBAAuBD,I,4LCpB7D,MAAMU,EAAWV,GAAUC,EAAAA,EAAAA,KAAS,kBAAmBD,GAGjDW,EAAcX,GAAUC,EAAAA,EAAAA,IAAQ,iBAAkB,CAAED,OAAAA,IAGpDY,EAAgBT,GAAMF,EAAAA,EAAAA,UAAW,aAAeE,GAGhDU,EAAab,GAAUC,EAAAA,EAAAA,KAAS,YAAaD,GAG7Cc,EAAcd,GAAUC,EAAAA,EAAAA,IAAQ,YAAaD,GAG7Ce,EAAcf,GAAUC,EAAAA,EAAAA,IAAQ,YAAa,CAAED,OAAAA,K,idC2D5D,MAAMgB,GAAOC,EAAAA,EAAAA,KAAIC,EAAAA,EAAAA,OAGXC,GAAcC,EAAAA,EAAAA,IAAS,CAC3BC,QAAS,EACTC,SAAU,GACVC,OAAQP,EAAKQ,MAAMC,QAAU,KAAOT,EAAKQ,MAAMrB,KAI3CuB,EAAc,KAElBP,EAAYI,OAAS,KAErBI,KAIIC,GAAUX,EAAAA,EAAAA,KAAI,GAEdY,GAAOZ,EAAAA,EAAAA,IAAI,IAEXa,GAAQb,EAAAA,EAAAA,IAAI,GAEZU,EAAY,KAEhBC,EAAQJ,OAAQ,GAEhBzB,EAAAA,EAAAA,IAAYoB,GACTY,MAAKC,IAEJH,EAAKL,MAAQQ,EAAIC,KAAKJ,KAEtBC,EAAMN,MAAQQ,EAAIC,KAAKH,SAExBI,SAAQ,KACPN,EAAQJ,OAAQ,MAGtBG,IAEA,MAAMQ,EAAehC,KACnBD,EAAAA,EAAAA,IAAcC,GAAI4B,MAAK,KACrBK,EAAAA,GAAAA,QAAwB,QACxBT,QAIEU,GAAWpB,EAAAA,EAAAA,IAAI,IACjBD,EAAKQ,MAAMC,UACbV,EAAAA,EAAAA,MAAcgB,MAAKC,IACjBK,EAASb,MAAQQ,EAAIC,QAIzB,MAAMK,EAAiBC,IACrBC,OAAOC,KAAK,OAASF,EAAIG,WAGrBC,GAAY1B,EAAAA,EAAAA,IAAI,IAChB2B,EAAgBC,IACpBF,EAAUnB,MAAQqB,EAClBF,EAAUnB,MAAMsB,MAAO,GAEnBC,EAAcC,IAClBL,EAAUnB,MAAQ,GAClBmB,EAAUnB,MAAMsB,MAAO,EACvBE,K,i/EC1IF,MAAMC,GAA2B,OAAgB,EAAQ,CAAC,CAAC,YAAY,qBAEvE","sources":["webpack://frontend/./src/api/file.js","webpack://frontend/./src/api/user.js","webpack://frontend/./src/views/file/index.vue","webpack://frontend/./src/views/file/index.vue?b881"],"sourcesContent":["import api from '@/utils/request'\n\n// 分页查询文件\nexport const filePageApi = params => api.get('/api/file/page', { params })\n\n// 删除文件\nexport const fileDeleteApi = id => api.delete('/api/file/' + id)\n\n// 上传文件\nexport const fileUploadApi = fd =>\n  api.post('/api/file/upload', fd, {\n    headers: {\n      'Content-Type': 'multipart/form-data'\n    }\n  })\n\n// 导出视频\nexport const exportVideoApi = params =>\n  api.post('/video-api/processVideo', params, {\n    hideMessage: true\n  })\n\n// 修改文件\nexport const fileEditApi = params => api.put('/api/file/setResult', params)\n","import api from '@/utils/request'\n\n// 登陆\nexport const loginApi = params => api.post('/api/user/login', params)\n\n// 分页查询用户\nexport const userPageApi = params => api.get('/api/user/page', { params })\n\n// 删除用户\nexport const userDeleteApi = id => api.delete('/api/user/' + id)\n\n// 新增用户\nexport const userAddApi = params => api.post('/api/user', params)\n\n// 修改用户\nexport const userEditApi = params => api.put('/api/user', params)\n\n// 获取用户列表\nexport const userListApi = params => api.get('/api/user', { params })\n","<template>\n  <div class=\"page\" v-loading=\"loading\">\n    <el-row :gutter=\"30\" v-if=\"user.isAdmin\">\n      <el-col :span=\"4\">\n        <el-select v-model=\"queryParams.userId\" placeholder=\"请选择用户\" clearable filterable>\n          <el-option\n            v-for=\"item in userList\"\n            :key=\"item.id\"\n            :label=\"item.username\"\n            :value=\"item.id\"\n          >\n          </el-option>\n        </el-select>\n      </el-col>\n      <el-col :span=\"8\">\n        <el-button type=\"primary\" @click=\"handleReset\">重置</el-button>\n        <el-button type=\"primary\" @click=\"queryList\">搜索</el-button>\n      </el-col>\n    </el-row>\n\n    <el-row :gutter=\"30\">\n      <el-col :span=\"24\">\n        <el-row :gutter=\"30\" v-if=\"list.length\">\n          <el-col :span=\"4\" v-for=\"item in list\" :key=\"item.id\">\n            <div class=\"item\">\n              <video :src=\"'/api' + item.filePath\" @click=\"handlePreview(item)\"></video>\n              <div class=\"name\">{{ item.fileName }}</div>\n              <div class=\"create\">{{ dayjs(item.createAt).format('YYYY-MM-DD HH:mm:ss') }}</div>\n              <div class=\"action\">\n                <i class=\"iconfont icon-xiazai\" @click=\"handleDownload(item)\"></i>\n                <el-popconfirm title=\"确定删除吗?\" @confirm=\"handleDelete(item.id)\">\n                  <template #reference>\n                    <i class=\"iconfont icon-shanchu\"></i>\n                  </template>\n                </el-popconfirm>\n              </div>\n            </div>\n          </el-col>\n        </el-row>\n        <el-empty v-else description=\"暂无素材\" />\n\n        <el-pagination\n          v-if=\"list.length\"\n          v-model:current-page=\"queryParams.pageNum\"\n          v-model:page-size=\"queryParams.pageSize\"\n          background\n          layout=\"total, prev, pager, next\"\n          :page-sizes=\"[10, 20, 50]\"\n          :total=\"total\"\n          @size-change=\"queryList\"\n          @current-change=\"queryList\"\n        />\n      </el-col>\n    </el-row>\n\n    <el-dialog\n      v-model=\"videoInfo.show\"\n      :title=\"videoInfo.fileName\"\n      :before-close=\"handleClose\"\n      width=\"50%\"\n    >\n      <video style=\"width: 100%\" :src=\"'/api' + videoInfo.filePath\" controls></video>\n    </el-dialog>\n  </div>\n</template>\n\n<script setup>\nimport { reactive, ref } from 'vue'\nimport dayjs from 'dayjs'\n\nimport { ElNotification } from 'element-plus'\n\nimport { filePageApi, fileDeleteApi } from '@/api/file'\n\nimport { getUser } from '@/utils/user'\nimport { userListApi } from '@/api/user'\n\nconst user = ref(getUser())\n\n// 查询参数\nconst queryParams = reactive({\n  pageNum: 1,\n  pageSize: 10,\n  userId: user.value.isAdmin ? null : user.value.id\n})\n\n// 重置搜索参数\nconst handleReset = () => {\n  // 重置搜索条件\n  queryParams.userId = null\n  // 查询列表\n  queryList()\n}\n\n// 加载状态\nconst loading = ref(false)\n// 列表\nconst list = ref([])\n// 总数\nconst total = ref(0)\n// 查询列表\nconst queryList = () => {\n  // 加载中\n  loading.value = true\n  // 查询列表\n  filePageApi(queryParams)\n    .then(res => {\n      // 保存列表\n      list.value = res.data.list\n      // 保存总数\n      total.value = res.data.total\n    })\n    .finally(() => {\n      loading.value = false\n    })\n}\nqueryList()\n\nconst handleDelete = id => {\n  fileDeleteApi(id).then(() => {\n    ElNotification.success(`删除成功`)\n    queryList()\n  })\n}\n\nconst userList = ref([])\nif (user.value.isAdmin) {\n  userListApi().then(res => {\n    userList.value = res.data\n  })\n}\n\nconst handleDownload = row => {\n  window.open('/api' + row.filePath)\n}\n\nconst videoInfo = ref({})\nconst handlePreview = item => {\n  videoInfo.value = item\n  videoInfo.value.show = true\n}\nconst handleClose = done => {\n  videoInfo.value = {}\n  videoInfo.value.show = false\n  done()\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.page {\n  width: 100%;\n  height: 100%;\n  padding: 20px;\n  .el-row {\n    // margin-bottom: 20px;\n    :deep(.el-select) {\n      width: 100%;\n    }\n  }\n\n  .item {\n    margin-top: 20px;\n    background: #1b1b1c;\n    border-radius: 5px;\n    margin-bottom: 20px;\n    overflow: hidden;\n    video {\n      width: 100%;\n      cursor: pointer;\n    }\n\n    div {\n      margin-top: 10px;\n      padding: 0 10px;\n      color: #fff;\n      &.name {\n        font-size: 16px;\n        font-weight: bold;\n      }\n      &.create {\n        font-size: 12px;\n      }\n      &.action {\n        padding-bottom: 10px;\n        display: flex;\n        justify-content: flex-end;\n        i {\n          font-size: 20px;\n          cursor: pointer;\n          margin-left: 10px;\n\n          &:hover {\n            opacity: 0.8;\n          }\n        }\n      }\n    }\n  }\n}\n</style>\n","import script from \"./index.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./index.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./index.vue?vue&type=style&index=0&id=f1fdc0c6&lang=scss&scoped=true\"\n\nimport exportComponent from \"/Users/pdxing/Desktop/order/20240104_vue+java仿剪映_3040/frontend/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-f1fdc0c6\"]])\n\nexport default __exports__"],"names":["filePageApi","params","api","fileDeleteApi","id","fileUploadApi","fd","headers","exportVideoApi","hideMessage","fileEditApi","loginApi","userPageApi","userDeleteApi","userAddApi","userEditApi","userListApi","user","ref","getUser","queryParams","reactive","pageNum","pageSize","userId","value","isAdmin","handleReset","queryList","loading","list","total","then","res","data","finally","handleDelete","ElNotification","userList","handleDownload","row","window","open","filePath","videoInfo","handlePreview","item","show","handleClose","done","__exports__"],"sourceRoot":""}